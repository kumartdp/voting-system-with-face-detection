import sqlite3
import numpy as np
import io

def adapt_array(arr):
    """
    http://stackoverflow.com/a/31312102/190597 (SoulNibbler)
    """
    out = io.BytesIO()
    np.save(out, arr)
    out.seek(0)
    return sqlite3.Binary(out.read())

def convert_array(text):
    out = io.BytesIO(text)
    out.seek(0)
    return np.load(out)


# Converts np.array to TEXT when inserting
sqlite3.register_adapter(np.ndarray, adapt_array)

# Converts TEXT to np.array when selecting
sqlite3.register_converter("array", convert_array)

x = np.arange(12).reshape(2,6)

x=[-0.16535115,  0.04271621,  0.08848196, -0.02222795, -0.02758434,
       -0.0752272 ,  0.02110191, -0.06844784,  0.13234499, -0.00765827,
        0.28413174, -0.08988197, -0.23781073, -0.09155332, -0.07848917,
        0.06574462, -0.10795502, -0.11570969, -0.08379157, -0.14691642,
       -0.01307386, -0.01240975,  0.02171447,  0.0232383 , -0.12371818,
       -0.30126616, -0.08083956, -0.11048337,  0.02910262, -0.11106488,
       -0.00203249,  0.05164857, -0.25422704, -0.12542734, -0.01436427,
        0.09557635, -0.01009352, -0.01827318,  0.17510997, -0.01094726,
       -0.04829294, -0.00164315,  0.07931995,  0.27051499,  0.19060829,
        0.08271348, -0.04925597, -0.02318999,  0.06514739, -0.2279118 ,
        0.0514572 ,  0.13869233,  0.16676946,  0.01016709,  0.11051782,
       -0.09522334, -0.02608683,  0.03401899, -0.09670129,  0.09534717,
        0.03066286, -0.04607379, -0.05600667, -0.08524629,  0.20601982,
        0.05830401, -0.07622775, -0.09488106,  0.22926567, -0.13064423,
       -0.04186404,  0.08711204, -0.06927484, -0.11797491, -0.27158764,
        0.11726031,  0.43014437,  0.0773173 , -0.16236094,  0.03735935,
       -0.11526464, -0.03806162, -0.00059122, -0.03051918, -0.11144032,
       -0.03289417, -0.14738989,  0.0015222 ,  0.19207071,  0.01661697,
       -0.06259856,  0.13713643, -0.05144623,  0.04846558,  0.06630541,
       -0.00071947, -0.10121947,  0.01403935, -0.12308327,  0.01039176,
        0.08888925, -0.12580268, -0.01461645,  0.10084219, -0.11459403,
        0.0204571 , -0.01631426, -0.03913156,  0.01195775,  0.09118252,
       -0.13900001, -0.06337681,  0.14289406, -0.28241676,  0.19990581,
        0.13877466, -0.01445151,  0.0859722 ,  0.08330388,  0.09144067,
        0.0175204 ,  0.06458296, -0.09947678, -0.14064819, -0.01800293,
       -0.02494724,  0.03114387,  0.07162781]

con = sqlite3.connect(":memory:", detect_types=sqlite3.PARSE_DECLTYPES)
cur = con.cursor()
cur.execute("create table test (arr array)")


cur.execute("insert into test (arr) values (?)", (x, ))


cur.execute("select arr from test")
data = cur.fetchone()[0]
print(data)
